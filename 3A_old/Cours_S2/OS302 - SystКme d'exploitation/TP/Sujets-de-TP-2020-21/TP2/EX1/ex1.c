#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/types.h>

#define EXIT_SUCCESS 0
#define EXIT_FAILURE 1

#define NB_BOUCLE 100

int main(void)
{
    pid_t pid_fils;
    int	etat;
    int i=1;

    sigset_t *p_ens;
    if (sigemptyset( p_ens)) puts("raté");
    if (sigaddset( p_ens, SIGUSR1)) puts("raté");
	sigprocmask(SIG_BLOCK, p_ens, NULL);

    pid_fils = fork();
    switch (pid_fils) {
    case -1:
        perror("Le fork a echoue");
		return EXIT_FAILURE;
    break;
    case 0:
        /*** FILS ***/		
		while(i<=NB_BOUCLE/2){
			if (sigwait(p_ens,&etat)) puts("erreur");
				printf("%d ",i*2);
				fflush(stdout);
			kill(getppid(),SIGUSR1);
			i++;
		}
		printf("\n");
    break;
    default:
        /*** PERE ***/
        while(i<=NB_BOUCLE/2){
				printf("%d ",i*2-1);
				fflush(stdout);
			kill(pid_fils,SIGUSR1);
			if (sigwait(p_ens,&etat)) puts("erreur"); 
			i++;
		}
		// sleep(1);
    }
    return EXIT_SUCCESS;
}
