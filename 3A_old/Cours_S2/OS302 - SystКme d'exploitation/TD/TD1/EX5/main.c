
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <signal.h>
#include <sys/types.h>
#include <sys/wait.h>


void sighandler(int sig){
	char* str = "Exception caught !\n";
	write(1,str,19);
	exit(1);
}

int main(void){
	
	pid_t pid;

	if( ( pid=fork() ) > 0 ){
	/* Parent process */
		printf("Initialisation...");
		fflush(stdout);
		sleep(2);
		int dead = kill(pid,0); // return 0 if OK
		if(!dead){
		printf("OK\nSending SIGUSR1 to child %d...",pid);
		fflush(stdout);
		kill(pid,SIGUSR1);
		printf("OK\nWaiting for child death...");
		fflush(stdout);
		int status;
		waitpid(pid,&status,0);
		printf("OK\nChild returned staus:%02X\n",status);
		} else printf("child was not alive ??\n");
	} else if (pid==0){
	/* Child process */
		signal(SIGUSR1,sighandler);
		while(1) sleep(1);
	} else {
	/* Error control routine */
		perror("no child created");
		exit(1);
	}

	return 0;
}





