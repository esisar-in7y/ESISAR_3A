#include <sys/types.h>
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/wait.h>

#define RED    "\033[0;31m"
#define BLUE   "\033[0;34m"
#define GREEN  "\033[0;32m"
#define YELLOW "\033[0;33m"
#define NC     "\033[0m"


int main (void) {
	
	pid_t pid,pid2;
	pid_t ownpid;

	if ((pid=fork())) if ( 0==(pid2 = fork()) ) pid = pid2;

	ownpid = getpid();

	if (pid == -1) {
		perror("Creation de processus");
		exit(2);
	}
	else if (pid == 0) {
		printf(NC "Je suis le " BLUE "fils " NC ". Mon PID est "GREEN "%d.\n" NC "", ownpid);
		// printf("Mon père est "GREEN "%d\n" NC "",getppid());
		sleep(1);
	}
	else {
		printf("Je suis le " RED "père " NC ". Mon PID est " GREEN "%d.\n" NC "", ownpid);
		waitpid(pid,NULL,0);
		printf("Mon premier enfant est mort. Il avait le PID " GREEN "%d.\n" NC "", pid);
		// printf( RED "routine terminée, mon père était " GREEN "%d\n" NC "", getppid() );
	}


	exit(0);
}
